kernel:
  image: KERNEL_TAG
  cmdline: "rootdelay=3"
init:
  - linuxkit/init:8f1e6a0747acbbb4d7e24dc98f97faa8d1c6cec7
  - linuxkit/runc:f01b88c7033180d50ae43562d72707c6881904e4
  - linuxkit/containerd:de1b18eed76a266baa3092e5c154c84f595e56da
  - linuxkit/getty:v0.5
  - linuxkit/memlogd:v0.5
  - DOM0ZTOOLS_TAG
  - GRUB_TAG
  - FW_TAG
  - XEN_TAG
  - GPTTOOLS_TAG
  - KEXEC_TAG
onboot:
   - name: rngd
     image: RNGD_TAG
     command: ["/sbin/rngd", "-1"]
   - name: sysctl
     image: linuxkit/sysctl:v0.5
     binds:
        - /etc/sysctl.d:/etc/sysctl.d
     capabilities:
        - CAP_SYS_ADMIN
        - CAP_NET_ADMIN
   - name: modprobe
     image: linuxkit/modprobe:v0.5
     command: ["/bin/sh", "-c", "modprobe -a nct6775 w83627hf_wdt hpwdt wlcore_sdio wl18xx br_netfilter dwc3 rk808 rk808-regulator smsc75xx cp210x nicvf tpm_tis_spi rtc_rx8010 gpio_pca953x leds_siemens_ipc127 upboard-fpga pinctrl-upboard leds-upboard xhci_tegra 2>/dev/null || :"]
   # If you change the order of storage-init don't forget to
   # change 003-installer in pkg/mkimage-raw-efi accordingly:
   # storage-init must follow installer
   - name: storage-init
     image: STORAGE_INIT_TAG
   # kdump goes strictly after storage-init
   - name: kdump
     image: KDUMP_TAG
   - name: pillar-onboot
     image: PILLAR_TAG
     command: ["/opt/zededa/bin/onboot.sh"]
services:
   - name: newlogd
     image: NEWLOGD_TAG
     cgroupsPath: /eve/services/newlogd
     oomScoreAdj: -999
   - name: edgeview
     image: EDGEVIEW_TAG
     cgroupsPath: /eve/services/eve-edgeview
     oomScoreAdj: -800
   - name: debug
     image: DEBUG_TAG
     cgroupsPath: /eve/services/debug
     oomScoreAdj: -999
   - name: wwan
     image: WWAN_TAG
     cgroupsPath: /eve/services/wwan
     oomScoreAdj: -999
   - name: wlan
     image: WLAN_TAG
     cgroupsPath: /eve/services/wlan
     oomScoreAdj: -999
   - name: guacd
     image: GUACD_TAG
     cgroupsPath: /eve/services/guacd
     oomScoreAdj: -999
   - name: pillar
     image: PILLAR_TAG
     cgroupsPath: /eve/services/pillar
     oomScoreAdj: -999
   - name: zedagent
     image: PILLAR_TAG
     cgroupsPath: /eve/services/zedagent
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "zedagent"]
   - name: ledmanager
     image: PILLAR_TAG
     cgroupsPath: /eve/services/ledmanager
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "ledmanager"]
   - name: domainmgr
     image: PILLAR_TAG
     cgroupsPath: /eve/services/domainmgr
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "domainmgr"]
   - name: nodeagent
     image: PILLAR_TAG
     cgroupsPath: /eve/services/nodeagent
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "nodeagent"]
   - name: nim
     image: PILLAR_TAG
     cgroupsPath: /eve/services/nim
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "nim"]
   - name: loguploader
     image: PILLAR_TAG
     cgroupsPath: /eve/services/loguploader
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "loguploader"]
   - name: tpmmgr
     image: PILLAR_TAG
     cgroupsPath: /eve/services/tpmmgr
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "tpmmgr"]
   - name: diag
     image: PILLAR_TAG
     cgroupsPath: /eve/services/diag
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "diag", "-f", "-o", "/dev/console"]
   - name: vaultmgr
     image: PILLAR_TAG
     cgroupsPath: /eve/services/vaultmgr
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "vaultmgr"]
   - name: zedmanager
     image: PILLAR_TAG
     cgroupsPath: /eve/services/zedmanager
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "zedmanager"]
   - name: zedrouter
     image: PILLAR_TAG
     cgroupsPath: /eve/services/zedrouter
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "zedrouter"]
   - name: downloader
     image: PILLAR_TAG
     cgroupsPath: /eve/services/downloader
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "downloader"]
   - name: verifier
     image: PILLAR_TAG
     cgroupsPath: /eve/services/verifier
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "verifier"]
   - name: baseosmgr
     image: PILLAR_TAG
     cgroupsPath: /eve/services/baseosmgr
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "baseosmgr"]
   - name: wstunnelclient
     image: PILLAR_TAG
     cgroupsPath: /eve/services/wstunnelclient
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "wstunnelclient"]
   - name: volumemgr
     image: PILLAR_TAG
     cgroupsPath: /eve/services/volumemgr
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "volumemgr"]
   - name: watcher
     image: PILLAR_TAG
     cgroupsPath: /eve/services/watcher
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "watcher"]
   - name: zfsmanager
     image: PILLAR_TAG
     cgroupsPath: /eve/services/zfsmanager
     oomScoreAdj: -999
     command: ["/opt/zededa/bin/agent-start.sh", "zfsmanager"]
   - name: vtpm
     image: VTPM_TAG
     cgroupsPath: /eve/services/vtpm
     oomScoreAdj: -999
   - name: watchdog
     image: WATCHDOG_TAG
     cgroupsPath: /eve/services/watchdog
     oomScoreAdj: -1000
   - name: xen-tools
     image: XENTOOLS_TAG
     cgroupsPath: /eve/services/xen-tools
     oomScoreAdj: -999
files:
   - path: /etc/eve-release
     contents: 'EVE_VERSION'
   - path: etc/linuxkit-eve-config.yml
     metadata: yaml
